{% extends "base.html" %}
{% block title %}Manage Mods{% endblock %}

{% block content %}
<section class="container">
  <h1>Manage Mods</h1>
  <p class="muted">Upload new mods or delete existing ones</p>

  <form action="{{ url_for('gluten.handle_upload') }}" method="POST" enctype="multipart/form-data" class="grid">
    <label>
      Title
      <input type="text" name="title" placeholder="Mod title" required>
    </label>

    <label>
      VPK File
      <input type="file" name="pak_file" accept=".vpk" required>
    </label>

    <button type="submit" class="button">Upload Mod</button>
  </form>

  <hr>

  <h2>Existing Mods</h2>

  {% if mods|length == 0 %}
    <p class="muted">No mods uploaded.</p>
  {% else %}
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Uploaded</th>
          <th>Size</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for mod in mods %}
        <tr>
          <td>{{ mod.title }}</td>
          <td>{{ mod.uploaded_at }}</td>
          <td>{{ (mod.size / 1024)|round(1) }} KB</td>
          <td>
            <form action="{{ url_for('gluten.delete_mod', mod_id=mod.id) }}" method="POST" onsubmit="return confirm('Delete this mod?')">
              <button class="button error">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>
{% endblock %}
