{% extends 'base.html' %}
{% block title %}DLNS • Home{% endblock %}
{% block content %}
<section class="card">
  <header>
    <h2>Latest Matches</h2>
    <p class="muted">Browse the most recent games played in DLNS and processed by the system. Games will be added when they hit the API, and processed.</p>
    <button type="button" class="chip-button" data-open-modal="#homeFilters">Filters <span class="chev" aria-hidden="true">▾</span></button>
  </header>
  
  <div id="matchesWrap">
    <div class="table-responsive">
      <table role="grid" class="striped" id="matchesTable">
        <thead>
          <tr>
            <th>Match</th>
            <th class="hide-on-mobile">Duration</th>
            <th class="hide-on-mobile">Winning Team</th>
            <th class="hide-on-mobile">Date Played</th>
          </tr>
        </thead>
        <tbody class="stagger-in">
          {% for m in latest %}
          <tr>
            <td>
              <a class="chip-button" href="{{ url_for('match_detail', match_id=m.match_id) }}">{{ m.match_id }}</a>
              <div class="show-on-mobile text-small text-muted" style="margin-top: 0.25rem;">
                {{ m.duration_s | format_duration }} • {{ m.winning_team | team_name }} • {{ (m.start_time or m.created_at)[:10] }}
              </div>
            </td>
            <td class="hide-on-mobile">{{ m.duration_s | format_duration }}</td>
            <td class="hide-on-mobile">
              <span class="{{ 'team-amber' if m.winning_team == 0 else 'team-sapphire' if m.winning_team == 1 else '' }}">
                {{ m.winning_team | team_name }}
              </span>
            </td>
            <td class="hide-on-mobile">
              <time class="dt" datetime="{{ m.start_time or m.created_at }}">
                {{ (m.start_time or m.created_at)[:10] }}
              </time>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4" class="table-empty">
              <h3>No matches yet</h3>
              <p>Check back later for the latest DLNS matches</p>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    <nav id="pager" class="pager" aria-label="Pagination">
      <button class="chip-button bounce-on-click" type="button" data-page="prev" disabled>
        <span aria-hidden="true">‹</span> Prev
      </button>
      <span class="muted" id="pageStat">Page 1</span>
      <button class="chip-button bounce-on-click" type="button" data-page="next" disabled>
        Next <span aria-hidden="true">›</span>
      </button>
    </nav>
  </div>
  
  <footer></footer>
</section>

<!-- Mobile search section -->
<section class="card show-on-mobile" style="margin-top: 1rem;">
  <header>
    <h3>Quick Search</h3>
  </header>
  <form action="{{ url_for('search') }}" method="get">
    <input type="search" name="q" placeholder="Search match ID or username" aria-label="Search" />
    <button type="submit" class="chip-button primary" style="margin-top: 0.5rem; width: 100%;">
      Search
    </button>
  </form>
</section>
{% endblock %}

{% block scripts %}{% endblock %}
